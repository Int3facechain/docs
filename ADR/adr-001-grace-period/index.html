<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ADR/adr-001-grace-period" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">ADR-001: Grace Period | Int3face Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://int3facechain.github.io/docs/ADR/adr-001-grace-period"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ADR-001: Grace Period | Int3face Docs"><meta data-rh="true" name="description" content="Status"><meta data-rh="true" property="og:description" content="Status"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://int3facechain.github.io/docs/ADR/adr-001-grace-period"><link data-rh="true" rel="alternate" href="https://int3facechain.github.io/docs/ADR/adr-001-grace-period" hreflang="en"><link data-rh="true" rel="alternate" href="https://int3facechain.github.io/docs/ADR/adr-001-grace-period" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/docs/assets/css/styles.0eb1cbbd.css">
<link rel="preload" href="/docs/assets/js/runtime~main.3802f890.js" as="script">
<link rel="preload" href="/docs/assets/js/main.c296a8ee.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.jpg" alt="Int3face Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logo.jpg" alt="Int3face Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Int3face</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/int3face/overview">Introduction</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Int3facechain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/docs/int3face/overview">1.0</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/int3face/overview">Int3face</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/comparisons/Int3face-THOR-Zeta">Comparisons</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/deployment/testnet">Deployments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/demos/btc/btc_inbound_outbound">Demos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/ADR/adr-001-grace-period">ADR</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ADR/adr-001-grace-period">ADR-001: Grace Period</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-002-dynamic-committee">ADR-002: Dynamic Committee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-003-babylon">ADR-003: Babylon Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-004-solana-integration">ADR-004 Solana Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-005-ordinals">ADR-005: Bitcoin Ordinals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-006-metrics">ADR-006: Metrics And Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-007-e2e-tests">ADR-007: E2E Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-008-automatic-signer-list">ADR-008: Automatic Signer List</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-009-blockchain-explorer">ADR-009: Blockchain Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-010-node-ungrades">ADR-010: Node Upgrades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-011-superfluid-staking">ADR-011: Superfluid Staking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-012-ton-integration">ADR-012 TON Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-013-rate-limiting">ADR-013: Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-014-babylon-finality">ADR-014: Babylon Finality</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">ADR</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ADR-001: Grace Period</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ADR-001: Grace Period</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="status">Status<a href="#status" class="hash-link" aria-label="Direct link to Status" title="Direct link to Status">​</a></h2><p>Done</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context">Context<a href="#context" class="hash-link" aria-label="Direct link to Context" title="Direct link to Context">​</a></h2><p>The outbound transfer consists of the following steps:</p><ol><li>Alice sends a MsgOutboundTransfer to the node.</li><li>The node adds this transaction to the block.</li><li>The blockchain executes this transaction.</li><li>The execution includes burning the corresponding tokens from Alice&#x27;s address.</li><li>The observer detects the MsgOutboundTransfer.</li><li>The observer adds it to the internal quest.</li><li>The observer uses the corresponding external chain client to build, sign, and broadcast the transaction.</li></ol><p><img loading="lazy" alt="outbound_current" src="/docs/assets/images/outbound_queue-95d4f9c0613c554989173004ac28f6a6.png" width="668" height="347" class="img_ev3q"></p><p>The flow is quite straightforward. However, dynamic committee handling involves many corner cases that we need to be aware of:</p><ol><li><strong>Observer reboots</strong>: Which block should the observer use if it reboots and misses some blocks?</li><li><strong>Majority is down</strong>: What happens if the majority of observers are down and the transaction cannot be signed?</li><li><strong>Observer failures</strong>: What if some observers cannot process the transfer for any reason?</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accepted-approach">Accepted approach<a href="#accepted-approach" class="hash-link" aria-label="Direct link to Accepted approach" title="Direct link to Accepted approach">​</a></h2><p>As seen, most problems arise from the pessimistic scenario where the majority is down. This scenario is highly unlikely, especially in a Proof-of-Authority system. Therefore, the solution relies on an optimistic mechanism. This means it is easy to handle when we trust the system, but more challenging (though not impossible) to manage in pessimistic cases.</p><p>The optimistic approach allows the observer to start monitoring the Int3face chain from the <strong>latest</strong> height. It may miss some transfers that occurred before, but they are not stuck as long as the majority of observers are active.</p><p>But what happens if the majority is down? In that case, the <strong>grace period</strong> is applied. The grace period is a specific time during which the user can submit <code>MsgOutboundTransferRetry</code>, which serves as a retry mechanism for <code>MsgOutboundTransfer</code>. For example, if the transfer is submitted at 10:20 and the execution time parameter is 2 hours, the grace period starts at 12:20 and lasts for a relatively long period, such as around 7 days.</p><p><img loading="lazy" alt="outbound_current" src="data:image/png;base64,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" width="839" height="95" class="img_ev3q"></p><p>During this time, the user can submit <code>MsgOutboundTransferRetry</code> containing the Int3face hash of the <code>MsgOutboundTransfer</code> transaction.</p><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">message</span><span class="token plain"> </span><span class="token class-name">MsgOutboundTransferRetry</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// TransferHash is the hash of the outbound transfer intended to retry.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> transfer_hash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Considering that, once the observer receives the <code>MsgOutboundTransferRetry</code> command, it goes through all transactions that occurred in the vault within the specified grace period and checks whether this transaction was executed before or not. If not, the observer executes it. However, vault transactions do not have any marking indicating the Int3face hash of the transfer. Therefore, this hash needs to be added to the memo of every transaction generated based on <code>MsgOutboundTransfer</code>.</p><p>Thus, the retry process looks like the following:</p><p><img loading="lazy" alt="outbound_current" src="/docs/assets/images/outbound_queue_retry-69856be91ed97a6c010646122ec3d5aa.png" width="797" height="439" class="img_ev3q"></p><p>And the observer start up is as follows:</p><p><img loading="lazy" alt="observer_reboot" src="/docs/assets/images/observer_reboot-1b4eba9c1a6751e3936e2a4918c89b29.png" width="669" height="366" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-approaches">Alternative approaches<a href="#alternative-approaches" class="hash-link" aria-label="Direct link to Alternative approaches" title="Direct link to Alternative approaches">​</a></h2><ol><li>Adding earliest-observer-height to allow observers to process blocks from the last stuck transfer.</li><li>Adding an on-chain stateful queue.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-implement">Steps to implement<a href="#steps-to-implement" class="hash-link" aria-label="Direct link to Steps to implement" title="Direct link to Steps to implement">​</a></h2><ol><li><code>MsgOutboundTransferRetry</code> handler: proto contract and MsgServer <a href="https://github.com/Int3facechain/bridge/issues/30" target="_blank" rel="noopener noreferrer">30</a>.</li><li>Validation for <code>MsgOutboundTransferRetry</code>: check that transfer_hash is present in Int3face <a href="https://github.com/Int3facechain/bridge/issues/30" target="_blank" rel="noopener noreferrer">30</a>.</li><li>Witnessing of <code>MsgOutboundTransferRetry</code> in the observer <a href="https://github.com/Int3facechain/bridge/issues/31" target="_blank" rel="noopener noreferrer">31</a>.</li><li>Include the original Int3face transfer hash in the transaction memo <a href="https://github.com/Int3facechain/bridge/issues/32" target="_blank" rel="noopener noreferrer">32</a>.</li><li>Vault history check mechanism <a href="https://github.com/Int3facechain/bridge/issues/33" target="_blank" rel="noopener noreferrer">33</a>.</li><li><code>MsgOutboundTransferRetry</code> observer processing <a href="https://github.com/Int3facechain/bridge/issues/33" target="_blank" rel="noopener noreferrer">33</a>.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consequences">Consequences<a href="#consequences" class="hash-link" aria-label="Direct link to Consequences" title="Direct link to Consequences">​</a></h2><ol><li>How to prevent DDoS attacks on <code>MsgOutboundTransferRetry</code>? What if a malicious user sends many requests, triggering multiple historical checks?</li><li>A special watcher may be implemented to automate the submission of <code>MsgOutboundTransferRetry</code>.</li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/demos/ton/ton_inbound_outbound"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TON demo</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ADR/adr-002-dynamic-committee"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ADR-002: Dynamic Committee</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#status" class="table-of-contents__link toc-highlight">Status</a></li><li><a href="#context" class="table-of-contents__link toc-highlight">Context</a></li><li><a href="#accepted-approach" class="table-of-contents__link toc-highlight">Accepted approach</a></li><li><a href="#alternative-approaches" class="table-of-contents__link toc-highlight">Alternative approaches</a></li><li><a href="#steps-to-implement" class="table-of-contents__link toc-highlight">Steps to implement</a></li><li><a href="#consequences" class="table-of-contents__link toc-highlight">Consequences</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/2xs9YvtpjF" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/_Bitfrost" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.int3face.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Int3facechain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Int3face. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.3802f890.js"></script>
<script src="/docs/assets/js/main.c296a8ee.js"></script>
</body>
</html>