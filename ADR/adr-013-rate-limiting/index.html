<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ADR/adr-013-rate-limiting" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">ADR-013: Rate Limiting | Int3face Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://int3facechain.github.io/docs/ADR/adr-013-rate-limiting"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ADR-013: Rate Limiting | Int3face Docs"><meta data-rh="true" name="description" content="Status"><meta data-rh="true" property="og:description" content="Status"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://int3facechain.github.io/docs/ADR/adr-013-rate-limiting"><link data-rh="true" rel="alternate" href="https://int3facechain.github.io/docs/ADR/adr-013-rate-limiting" hreflang="en"><link data-rh="true" rel="alternate" href="https://int3facechain.github.io/docs/ADR/adr-013-rate-limiting" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/docs/assets/css/styles.0eb1cbbd.css">
<link rel="preload" href="/docs/assets/js/runtime~main.e1e83e7e.js" as="script">
<link rel="preload" href="/docs/assets/js/main.f2581ca5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.jpg" alt="Int3face Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logo.jpg" alt="Int3face Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Int3face</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/int3face/overview">Introduction</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Int3facechain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/docs/int3face/overview">1.0</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/int3face/overview">Int3face</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/comparisons/Int3face-THOR-Zeta">Comparisons</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/deployment/testnet">Deployments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/demos/btc/btc_inbound_outbound">Demos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/ADR/adr-001-grace-period">ADR</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-001-grace-period">ADR-001: Grace Period</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-002-dynamic-committee">ADR-002: Dynamic Committee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-003-babylon">ADR-003: Babylon Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-004-solana-integration">ADR-004 Solana Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-005-ordinals">ADR-005: Bitcoin Ordinals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-006-metrics">ADR-006: Metrics And Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-007-e2e-tests">ADR-007: E2E Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-008-automatic-signer-list">ADR-008: Automatic Signer List</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-009-blockchain-explorer">ADR-009: Blockchain Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-010-node-ungrades">ADR-010: Node Upgrades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-011-superfluid-staking">ADR-011: Superfluid Staking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-012-ton-integration">ADR-012 TON Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ADR/adr-013-rate-limiting">ADR-013: Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ADR/adr-014-babylon-finality">ADR-014: Babylon Finality</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">ADR</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ADR-013: Rate Limiting</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ADR-013: Rate Limiting</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="status">Status<a href="#status" class="hash-link" aria-label="Direct link to Status" title="Direct link to Status">​</a></h2><p>Design</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context-rate-limit">Context: Rate Limit<a href="#context-rate-limit" class="hash-link" aria-label="Direct link to Context: Rate Limit" title="Direct link to Context: Rate Limit">​</a></h2><p><strong>Rate limiting</strong> is a strategy used to restrict the amount of incoming volume over a specified period of time. For
instance, consider a scenario where the limit is set to 5 BTC every day. Should the module receive more than 5 BTC
within this 24-hours timeframe, any excess volume above the permitted amount would not be minted and instead be placed
in <strong>quarantine</strong> (for more details, please see the <a href="#quarantine">Quarantine</a> section). This approach is crucial for
ensuring chain security, as it prevents the system from being overwhelmed by excessive, uncontrolled minting.
Essentially, rate limiting acts as a safeguard, setting a maximum on potential losses the chain might incur due to
unforeseen malicious activities.</p><p>The Int3face rate limiting is inspired
by <a href="https://github.com/osmosis-labs/osmosis/tree/main/x/ibc-rate-limit" target="_blank" rel="noopener noreferrer">the Osmosis IBC Rate Limiting</a>
and <a href="https://github.com/Stride-Labs/ibc-rate-limiting/tree/main" target="_blank" rel="noopener noreferrer">the Stride-Labs native golang module</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context-quarantine">Context: Quarantine<a href="#context-quarantine" class="hash-link" aria-label="Direct link to Context: Quarantine" title="Direct link to Context: Quarantine">​</a></h2><p>The <strong>quarantine</strong> mechanism ensures the smooth handling of inbound transfers, even during periods when asset activity
is paused due to rate limiting, maintenance, or other factors that might otherwise halt the minting process.</p><p>The <strong>quarantine</strong> solves the following problem: when the module is unable to process transfers for reasons like
exceeding rate limits, maintenance shutdowns, or other transfer-blocking circumstances, it cannot accept new transfers.
For outbound transfers, this is straightforward, as new requests are simply rejected with an error message. However,
managing inbound transfers is more complex. Users perceive inbound transfers as transactions to the dedicated <strong>vault</strong>,
and since the incoming flow on external chains can&#x27;t be directly controlled, users might continue sending transfers
irrespective of module availability.</p><p>Refunding these transfers could be an option, but it&#x27;s neither efficient nor entirely secure. Therefore, the *
*quarantine<strong> approach is employed. Transfers that cannot be minted immediately are placed in the </strong>quarantine<strong>, to be
processed at a later, more suitable time. Crucially, </strong>quarantine** does not block transfers; it merely defers them.
This process is transparent, informing users that their transfers are delayed but will be processed as soon as
conditions allow.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="existing-hacks">Existing Hacks<a href="#existing-hacks" class="hash-link" aria-label="Direct link to Existing Hacks" title="Direct link to Existing Hacks">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="polygon">Polygon<a href="#polygon" class="hash-link" aria-label="Direct link to Polygon" title="Direct link to Polygon">​</a></h3><ul><li>The Polygon bridge hack in 2022 was caused by a vulnerability in the smart contract logic. The issue was that one privileged contract could call another contract, allowing the attacker to drain funds.</li><li>The vulnerability was due to a lack of proper access controls and validation in the contract code. This allowed the attacker to bypass intended security measures.</li><li>The hack resulted in the loss of over $190 million worth of crypto assets.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bnb-chain">BNB Chain<a href="#bnb-chain" class="hash-link" aria-label="Direct link to BNB Chain" title="Direct link to BNB Chain">​</a></h3><ul><li>The BNB Chain bridge hack in 2022 was due to a vulnerability in the Merkle root verification process in the smart contract.</li><li>Attackers were able to forge Merkle proofs, allowing them to withdraw funds from the bridge contract.</li><li>This was caused by insufficient validation of the Merkle proof data submitted by users when making withdrawals.</li><li>Approximately $570 million was stolen in this attack.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wormhole">Wormhole<a href="#wormhole" class="hash-link" aria-label="Direct link to Wormhole" title="Direct link to Wormhole">​</a></h3><ul><li>The Wormhole bridge, which connects Solana to other blockchains, was hacked in 2022 due to issues with Solana signature verification in the smart contracts.</li><li>Attackers were able to forge Solana signatures, tricking the bridge contract into approving unauthorized transfers.</li><li>This was a result of improper validation of the Solana-originated data used in the bridge&#x27;s logic.</li><li>The hack led to the loss of over $320 million in crypto assets.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thorchain">THORChain<a href="#thorchain" class="hash-link" aria-label="Direct link to THORChain" title="Direct link to THORChain">​</a></h3><ul><li>The THORChain bridge was hacked multiple times in 2021 due to vulnerabilities in the Bifrost Go code used in the project.</li><li>The issues allowed attackers to exploit the bridge&#x27;s liquidity pools and drain funds.</li><li>The vulnerabilities were related to the complex cross-chain transaction handling and security measures implemented in the Bifrost Go code.</li><li>THORChain lost over $8 million in these attacks.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limiting-accepted-approach">Rate Limiting: Accepted approach<a href="#rate-limiting-accepted-approach" class="hash-link" aria-label="Direct link to Rate Limiting: Accepted approach" title="Direct link to Rate Limiting: Accepted approach">​</a></h2><p>Each rate limit has a configurable threshold that dictates the max inflow/outflow along the cross-chain asset. The
threshold is represented as a percentage of the total value. The channel value is calculated by querying the total
supply of the denom at the start of the time window, and it remains constant until the window expires. For instance, the
rate limit described above might have a threshold of 10% for both inflow and outflow. If the total supply
of <code>bitcoin-btc</code> was 100, then any transfer that would cause a net inflow or outflow greater than 10 (i.e. greater than
10% the channel value) would be rejected. Once the time window expires, the net inflow and outflow are reset to 0 and
the channel value is re-calculated.</p><p>The <em>net inflow</em> and outflow is used (rather than the total inflow/outflow) to prevent DOS attacks where someone
repeatedly sends the same token back and forth across the same channel, causing the rate limit to be reached.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3><p>Let&#x27;s say we created a 24-hour rate limit on <code>bitcoin-btc</code> with a 10% send and receive threshold.</p><ol><li>At the start of the window, the supply will be queried, to determine the channel value. Let&#x27;s say the total supply
was 100</li><li>If someone transferred <code>8bitcoin-btc</code> from <code>Bitcoin -&gt; Int3face</code>, the <code>Inflow</code> would increment by 8</li><li>If someone tried to transfer another <code>8bitcoin-btc</code> from <code>Bitcoin -&gt; Int3face</code>, it would exceed the quota
since <code>(8+8)/100 = 16%</code> (which is greater than 10%) and thus, the transfer would be rejected.</li><li>If someone tried to transfer <code>8bitcoin-btc</code> from <code>Int3face -&gt; Bitcoin</code>, the <code>Outflow</code> would increment by 12. Notice,
even
though 12 is greater than 10% the total channel value, the <em>net</em> outflow is only <code>8bitcoin-btc</code> (since it&#x27;s offset by
the <code>8btc</code> <code>Inflow</code>). As a result, this transaction would succeed.</li><li>Now if the person in (3) attempted to retry their transfer of<code>8bitcoin-btc</code> from <code>Bitcoin -&gt; Int3face</code>, the <code>Inflow</code>
would increment by 8 and the transaction would succeed (leaving a net inflow of 4).</li><li>Finally, at the end of the 24 hours, the <code>Inflow</code> and <code>Outflow</code> would get reset to 0 and the <code>ChannelValue</code> would be
re-calculated. In this example, the new channel value would be 104 (since more <code>bitcoin-btc</code> was sent to Stride, and
thus more <code>bitcoin-btc</code> was minted)</li></ol><table><thead><tr><th align="center">Step</th><th align="center">Description</th><th align="center">Transfer Status</th><th align="center">Inflow</th><th align="center">Outflow</th><th align="center">Net Inflow</th><th align="center">Net Outflow</th><th align="center">Channel Value</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">Rate limit created</td><td align="center"></td><td align="center">0</td><td align="center">0</td><td align="center"></td><td align="center"></td><td align="center">100</td></tr><tr><td align="center">2</td><td align="center">8bitcoin-btc Bitcoin → Int3face</td><td align="center">Successful</td><td align="center">8</td><td align="center">0</td><td align="center">8%</td><td align="center"></td><td align="center">100</td></tr><tr><td align="center">3.1</td><td align="center">8bitcoin-btc Bitcoin → Int3face</td><td align="center">Rejected</td><td align="center">16</td><td align="center">0</td><td align="center">16% (&gt;10%)</td><td align="center"></td><td align="center">100</td></tr><tr><td align="center">3.2</td><td align="center">The TX is put into the quarantine</td><td align="center"></td><td align="center">8</td><td align="center">0</td><td align="center">8%</td><td align="center"></td><td align="center">100</td></tr><tr><td align="center">4</td><td align="center">12bitcoin-btc Int3face → Bitcoin</td><td align="center">Successful</td><td align="center">8</td><td align="center">12</td><td align="center"></td><td align="center">4%</td><td align="center">100</td></tr><tr><td align="center">5</td><td align="center">8bitcoin-btc Bitcoin → Int3face</td><td align="center">Successful</td><td align="center">16</td><td align="center">12</td><td align="center">4%</td><td align="center"></td><td align="center">100</td></tr><tr><td align="center">6</td><td align="center">Quota Reset</td><td align="center"></td><td align="center">0</td><td align="center">0</td><td align="center"></td><td align="center"></td><td align="center">104</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quarantine-accepted-approach">Quarantine: Accepted approach<a href="#quarantine-accepted-approach" class="hash-link" aria-label="Direct link to Quarantine: Accepted approach" title="Direct link to Quarantine: Accepted approach">​</a></h2><p>The <strong>quarantining</strong> might be initiated right after an inbound transfer reaches the required number of votes for
processing. When a transfer receives the final necessary vote, the module evaluates it against the asset&#x27;s rate limits.
If the transfer exceeds these limits, it is added to the end of the quarantine queue. This queue can be activated for
processing through a governance proposal. Notably, <strong>quarantining</strong> allows for partial execution: if a part of the
transfer falls within the rate limits, that portion will be minted, while the remainder goes into the queue.</p><p>There are two methods for managing quarantined assets:</p><ul><li>Simply storing the queue in the state. Here, if rate limits are exceeded, the coins are added to the state queue
without minting. Upon release, the tokenfactory&#x27;s Mint function is called for the relevant addresses.</li><li>Minting all coins to a special <strong>quarantine</strong> address (not the destination address) immediately after finalization.
The coins are then transferred to their intended addresses upon release following a governance proposal. This method
still requires the state queue, but operations are based solely on straightforward transfers. It also offers a
transparent view of the <strong>quarantine</strong>, represented by a dedicated <strong>quarantine</strong> vault on Int3face.</li></ul><p><img loading="lazy" alt="quarantine" src="/docs/assets/images/quarantine-e9ed906f64712730aab51ec82e47eecc.png" width="934" height="414" class="img_ev3q"></p><p>For <strong>quarantining</strong>, a queue is utilized instead of a map to allow sequential execution of transfers and to potentially
filter out malicious transactions. To better understand the difference, consider the following example.</p><p>Suppose transfers are stored in a map. In this case, when releasing assets from the <strong>quarantining</strong> vault, the only
available figure is the total volume of transfers to addresses, as depicted in the following diagram:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Alice_destination_addr -&gt; 9 + 7 + 3 = 19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bob_destination_addr   -&gt; 1 + 2 = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Conversely, when using a queue, the same data might be represented as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dest  : Alice_destination_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    amount: 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dest  : Alice_destination_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    amount: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dest  : Alice_destination_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    amount: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dest  : Bob_destination_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    amount: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dest  : Bob_destination_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    amount: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Imagine the module detects unusual activity at height 6. It could then decide to mint all coins except those associated
with that specific height. It&#x27;s important to note that the order of elements in the queue is not significant. The queue
is merely a practical data structure for storage purposes.</p><p>While the queue cannot eliminate all malicious transfers, it can help segregate them and make them less harmful. As a
security measure, periodically matching the total supply of minted assets with the balances in external vaults can help
identify fraudulent activity.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="questions">Questions<a href="#questions" class="hash-link" aria-label="Direct link to Questions" title="Direct link to Questions">​</a></h2><ol><li>Net flow rate limiting VS Direction-based rate-limiting</li><li>DoS attacks to quarantining queue:<ol><li>Do we need to limit the queue?</li><li>How to process infinitely-growing queue?</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-approaches">Alternative approaches<a href="#alternative-approaches" class="hash-link" aria-label="Direct link to Alternative approaches" title="Direct link to Alternative approaches">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-implement">Steps to implement<a href="#steps-to-implement" class="hash-link" aria-label="Direct link to Steps to implement" title="Direct link to Steps to implement">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xratelimit">x/ratelimit<a href="#xratelimit" class="hash-link" aria-label="Direct link to x/ratelimit" title="Direct link to x/ratelimit">​</a></h3><ol><li><code>x/ratelimit</code> design document</li><li><code>x/ratelimit</code> proto contracts</li><li><code>x/ratelimit</code> module scaffolding</li><li><code>x/ratelimit</code> types validation and unit tests</li><li><code>x/ratelimit</code> draft keeper</li><li><code>x/ratelimit</code> MsgServer and state updates</li><li><code>x/ratelimit</code> import/export genesis</li><li><code>x/ratelimit</code> integration tests</li><li><code>x/bridge</code> support for <code>x/ratelimit</code></li><li><code>x/bridge</code> integration tests</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xquarantine">x/quarantine<a href="#xquarantine" class="hash-link" aria-label="Direct link to x/quarantine" title="Direct link to x/quarantine">​</a></h3><ol><li><code>x/quarantine</code> design document</li><li><code>x/quarantine</code> proto contracts</li><li><code>x/quarantine</code> module scaffolding</li><li><code>x/quarantine</code> types validation and unit tests</li><li><code>x/quarantine</code> draft keeper</li><li><code>x/quarantine</code> MsgServer and state updates</li><li><code>x/quarantine</code> import/export genesis</li><li><code>x/quarantine</code> integration tests</li><li><code>x/ratelimit</code> support for <code>x/quarantine</code></li><li><code>x/ratelimit</code> integration tests</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2><ul><li><a href="https://github.com/osmosis-labs/osmosis/tree/main/x/ibc-rate-limit" target="_blank" rel="noopener noreferrer">Osmosis IBC Rate Limiting</a></li><li><a href="https://github.com/Stride-Labs/ibc-rate-limiting/tree/main" target="_blank" rel="noopener noreferrer">Stride-Labs native golang module</a>.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/ADR/adr-012-ton-integration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ADR-012 TON Integration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ADR/adr-014-babylon-finality"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ADR-014: Babylon Finality</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#status" class="table-of-contents__link toc-highlight">Status</a></li><li><a href="#context-rate-limit" class="table-of-contents__link toc-highlight">Context: Rate Limit</a></li><li><a href="#context-quarantine" class="table-of-contents__link toc-highlight">Context: Quarantine</a></li><li><a href="#existing-hacks" class="table-of-contents__link toc-highlight">Existing Hacks</a><ul><li><a href="#polygon" class="table-of-contents__link toc-highlight">Polygon</a></li><li><a href="#bnb-chain" class="table-of-contents__link toc-highlight">BNB Chain</a></li><li><a href="#wormhole" class="table-of-contents__link toc-highlight">Wormhole</a></li><li><a href="#thorchain" class="table-of-contents__link toc-highlight">THORChain</a></li></ul></li><li><a href="#rate-limiting-accepted-approach" class="table-of-contents__link toc-highlight">Rate Limiting: Accepted approach</a><ul><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#quarantine-accepted-approach" class="table-of-contents__link toc-highlight">Quarantine: Accepted approach</a></li><li><a href="#questions" class="table-of-contents__link toc-highlight">Questions</a></li><li><a href="#alternative-approaches" class="table-of-contents__link toc-highlight">Alternative approaches</a></li><li><a href="#steps-to-implement" class="table-of-contents__link toc-highlight">Steps to implement</a><ul><li><a href="#xratelimit" class="table-of-contents__link toc-highlight">x/ratelimit</a></li><li><a href="#xquarantine" class="table-of-contents__link toc-highlight">x/quarantine</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/2xs9YvtpjF" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/_Bitfrost" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.int3face.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Int3facechain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Int3face. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.e1e83e7e.js"></script>
<script src="/docs/assets/js/main.f2581ca5.js"></script>
</body>
</html>